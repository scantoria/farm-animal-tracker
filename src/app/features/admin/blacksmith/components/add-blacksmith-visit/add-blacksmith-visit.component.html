<div class="container">
  <h2>Add Blacksmith Visit for: {{animalId}}</h2>
  
  <form #visitForm="ngForm" (ngSubmit)="onSubmit(visitForm)">
<!--//
    <label for="provider">Blacksmith (Provider Name):</label>
    <select 
      id="provider" 
      name="provider" 
      [(ngModel)]="selectedProviderName" 
      required 
      #providerControl="ngModel"
    >
      <option value="" disabled>Select Blacksmith</option>
      <option *ngFor="let bs of blacksmiths$ | async" [value]="bs.name">
        {{ bs.name }}
      </option>
    </select>
    <div *ngIf="providerControl.invalid && (providerControl.dirty || providerControl.touched)">
      <div *ngIf="providerControl.errors?.['required']" class="text-danger small">Blacksmith is required.</div>
    </div>
//-->

    <label for="provider">Blacksmith (Provider Name):</label>
    <select 
      id="provider" 
      name="provider" 
      [(ngModel)]="visitData.provider" 
      required 
      #providerControl="ngModel"
    >
      <option value="" disabled>Select Blacksmith</option>
      <option *ngFor="let bs of blacksmiths$ | async" [value]="bs.name">
        {{ bs.name }}
      </option>
    </select>
    <div *ngIf="providerControl.invalid && (providerControl.dirty || providerControl.touched)">
      <div *ngIf="providerControl.errors?.['required']" class="text-danger small">Blacksmith is required.</div>
    </div>

    <label for="visitDate">Visit Date:</label>
    <input 
      type="date" 
      id="visitDate" 
      name="visitDate" 
      [(ngModel)]="visitData.visitDate" 
      #visitDate="ngModel"
      required
    >
    <div *ngIf="visitDate.invalid && (visitDate.dirty || visitDate.touched)">
      <div *ngIf="visitDate.errors?.['required']" class="text-danger small">Visit Date is required.</div>
    </div>

    <label for="serviceProvided">Service Provided:</label>
    <select 
      id="serviceProvided" 
      name="serviceProvided" 
      [(ngModel)]="visitData.serviceProvided" 
      required 
      #serviceProvided="ngModel"
    >
      <option value="" disabled>Select Service</option>
      <option *ngFor="let service of serviceOptions" [value]="visitData.serviceProvided">
        {{ service }}
      </option>
    </select>
    <div *ngIf="serviceProvided.invalid && (serviceProvided.dirty || serviceProvided.touched)">
      <div *ngIf="serviceProvided.errors?.['required']" class="text-danger small">Service Provided is required.</div>
    </div>

    <label for="nextAppointmentDate">Next Appointment Date (Optional):</label>
    <input type="date" id="nextAppointmentDate" name="nextAppointmentDate" [(ngModel)]="visitData.nextAppointmentDate">
    <label for="notes">Notes:</label>
    <textarea id="notes" name="notes" rows="3" [(ngModel)]="visitData.notes"></textarea>

    <div class="mt-4">
      <button type="submit" class="btn btn-primary" [disabled]="visitForm.invalid">Add Visit</button>
      <button type="button" class="btn btn-secondary ms-2" (click)="onCancel()">Cancel</button>
    </div>
  </form>
</div>
